{% extends 'base.html' %}
{% load static %}

{% block title %}My Notifications - Harrier Car Store{% endblock %}

{% block content %}
<div class="page-heading">
    <div class="container">
        <div class="row">
            <div class="col-xs-12">
                <div class="page-title">
                    <h2>My Notifications</h2>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="main-container col1-layout">
    <div class="main container">
        <div class="row">
            <div class="col-sm-12">

                <!-- Messages -->
                {% if messages %}
                <div class="std">
                    {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}"
                        style="padding: 15px; margin-bottom: 15px; border-radius: 4px; background: #dff0d8; color: #3c763d; border: 1px solid #d6e9c6;">
                        {{ message }}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}

                <!-- Filter Tabs -->
                <div class="my-account" style="margin-bottom: 20px;">
                    <div class="dashboard">
                        <div class="box-account" style="padding: 15px;">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">

                                <!-- Filter Buttons -->
                                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                    <a href="{% url 'notifications' %}?status=all" class="button"
                                        style="{% if filter_status == 'all' %}background: #ed6663; color: #fff;{% else %}background: #f5f5f5; color: #333;{% endif %} padding: 8px 20px; border-radius: 3px; text-decoration: none; font-size: 13px; font-weight: 600;">
                                        All ({{ total_count }})
                                    </a>
                                    <a href="{% url 'notifications' %}?status=unread" class="button"
                                        style="{% if filter_status == 'unread' %}background: #ed6663; color: #fff;{% else %}background: #f5f5f5; color: #333;{% endif %} padding: 8px 20px; border-radius: 3px; text-decoration: none; font-size: 13px; font-weight: 600;">
                                        Unread ({{ unread_count }})
                                    </a>
                                    <a href="{% url 'notifications' %}?status=read" class="button"
                                        style="{% if filter_status == 'read' %}background: #ed6663; color: #fff;{% else %}background: #f5f5f5; color: #333;{% endif %} padding: 8px 20px; border-radius: 3px; text-decoration: none; font-size: 13px; font-weight: 600;">
                                        Read ({{ read_count }})
                                    </a>
                                </div>

                                <!-- Mark All as Read Button -->
                                {% if unread_count > 0 %}
                                <a href="{% url 'mark_all_notifications_read' %}" class="button"
                                    style="background: #6c6; color: #fff; padding: 8px 20px; border-radius: 3px; text-decoration: none; font-size: 13px; font-weight: 600;">
                                    <i class="fa fa-check-circle"></i> Mark All as Read
                                </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Notifications List -->
                {% if notifications %}
                <div class="my-account">
                    <div class="dashboard">
                        <div class="box-account box-recent">
                            <div class="box-head">
                                <h2>
                                    {% if filter_status == 'unread' %}
                                    Unread Notifications
                                    {% elif filter_status == 'read' %}
                                    Read Notifications
                                    {% else %}
                                    All Notifications
                                    {% endif %}
                                </h2>
                            </div>

                            <div class="table-responsive">
                                <table class="data-table" style="width: 100%;">
                                    <tbody>
                                        {% for notification in notifications %}
                                        <tr
                                            style="{% if not notification.is_read %}background: #fffbf0;{% endif %} border-bottom: 1px solid #eee;">
                                            <td style="padding: 15px; width: 50px;">
                                                <div
                                                    style="width: 40px; height: 40px; border-radius: 50%; background: {% if not notification.is_read %}#ed6663{% else %}#ddd{% endif %}; display: flex; align-items: center; justify-content: center; color: #fff; font-size: 18px;">
                                                    <i class="fa fa-bell"></i>
                                                </div>
                                            </td>
                                            <td style="padding: 15px;">
                                                {% if not notification.is_read %}
                                                <span
                                                    style="display: inline-block; padding: 2px 8px; background: #ed6663; color: #fff; border-radius: 3px; font-size: 10px; font-weight: 700; text-transform: uppercase; margin-bottom: 5px;">
                                                    New
                                                </span>
                                                {% endif %}
                                                <p
                                                    style="margin: 5px 0; font-size: 14px; line-height: 1.6; color: #333; font-weight: {% if not notification.is_read %}600{% else %}400{% endif %};">
                                                    {{ notification.message }}
                                                </p>
                                                <small style="color: #999; font-size: 12px;">
                                                    <i class="fa fa-clock-o"></i> {{ notification.created_at|date:"F d, Y - H:i" }}
                                                </small>
                                            </td>
                                            <td style="padding: 15px; text-align: right; white-space: nowrap;">
                                                {% if not notification.is_read %}
                                                <a href="{% url 'mark_notification_read' notification.id %}"
                                                    class="button" title="Mark as Read"
                                                    style="background: #6c6; color: #fff; padding: 6px 12px; border-radius: 3px; text-decoration: none; font-size: 12px; margin-right: 5px;">
                                                    <i class="fa fa-check"></i>
                                                </a>
                                                {% endif %}
                                                <a href="{% url 'delete_notification' notification.id %}" class="button"
                                                    title="Delete"
                                                    onclick="return confirm('Are you sure you want to delete this notification?');"
                                                    style="background: #ed6663; color: #fff; padding: 6px 12px; border-radius: 3px; text-decoration: none; font-size: 12px;">
                                                    <i class="fa fa-trash"></i>
                                                </a>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                {% else %}
                <!-- Empty State -->
                <div class="my-account">
                    <div class="dashboard">
                        <div class="box-account" style="padding: 60px 20px; text-align: center;">
                            <div
                                style="width: 80px; height: 80px; border-radius: 50%; background: #f5f5f5; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center;">
                                <i class="fa fa-bell-slash" style="font-size: 40px; color: #999;"></i>
                            </div>
                            <h3 style="font-size: 20px; color: #666; margin-bottom: 10px; font-weight: 600;">
                                {% if filter_status == 'unread' %}
                                No Unread Notifications
                                {% elif filter_status == 'read' %}
                                No Read Notifications
                                {% else %}
                                No Notifications Yet
                                {% endif %}
                            </h3>
                            <p style="color: #999; font-size: 14px; margin: 0;">
                                {% if filter_status == 'all' %}
                                You don't have any notifications at the moment.
                                {% elif filter_status == 'unread' %}
                                All caught up! You have no unread notifications.
                                {% else %}
                                You haven't read any notifications yet.
                                {% endif %}
                            </p>
                        </div>
                    </div>
                </div>
                {% endif %}

            </div>
        </div>
    </div>
</div>

<style>
    /* Hover effects for buttons */
    .button:hover {
        opacity: 0.9;
        transform: translateY(-1px);
        transition: all 0.3s ease;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .table-responsive table td {
            display: block;
            width: 100% !important;
            text-align: left !important;
        }

        .table-responsive table tr {
            display: block;
            margin-bottom: 15px;
            border: 1px solid #eee;
            border-radius: 4px;
        }
    }
</style>
{% endblock %}